<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Feed</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="/public/feed.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/public/home.css" />
    <script src="/public/script.js" defer></script>
  </head>

  <body>
    <header><%- include('partials/navbar') %></header>

    <div class="columns">
      <div id="feed">
        <div id="feed-header">
          <h1><%= category.catName %> Feed</h1>
        </div>
        <div class="nav-buttons">
          <button
            id="viewPostsButton"
            class="btn btn-secondary"
            onclick="toggleView('posts')"
          >
            View Posts
          </button>
          <button
            id="viewResourcesButton"
            class="btn btn-secondary"
            onclick="toggleView('resources')"
          >
            View Resources
          </button>
          <% if (role==='teacher' ) { %>
          <div>
            <button
              type="button"
              class="btn btn-primary"
              data-bs-toggle="modal"
              data-bs-target="#resourceModal"
            >
              Add Resource
            </button>
          </div>
          <% } %>
          <div>
            <button
              type="button"
              id="postButton"
              class="btn btn-primary"
              data-bs-toggle="modal"
              data-bs-target="#postModal"
            >
              Post
            </button>
          </div>
        </div>
       
        <div id="feed-content" style="position: relative;">
          <% if (!posts || posts.length === 0) { %>
            <h2>No posts found, be the first to make one!</h2>
          <% } else { %>
            <% posts.forEach(post => { %>
              <div class="grows" style="position: relative; margin-bottom: 320px; display: flex; flex-direction: column;"> <!-- Added margin for spacing, flex, and column direction -->
                <div id="postBox" style="width: 700px; height: 300px; left: 76px; top: 107px; position: absolute; background: rgb(255, 251, 215);  border-radius: 19px; border: 3px rgb(0, 0, 0) solid; "></div>
                <div class="grows" style="width: 40px; height: 40px; left: 94px; top: 320px; position: absolute; background: white; border-radius: 9999px; border: 1px black solid;">
                  <a href="/account/<%= post.userId %>">
                    <img
                    src="/images/<%= post.profilePic %>"
                    class="rounded-circle"
                    alt="profile"
                    style="width: 100%; height: 100%; object-fit: cover;">
                  </a>
                </div>
                <div style="width: 500px; height: 27px; left: 146px; top: 325px; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; word-wrap: break-word;">
                  <a href="/account/<%= post.userId %>">
                    <%= post.fname + " " + post.lname %>
                  </a>
                </div>
                <div id="dots" class="grows" style="position: absolute; left: 690px; top: 320px;" onclick="toggleButtons('buttons-<%= post.postId %>')"> <!-- Pass the specific buttons ID -->
                  <div class="dot"></div>
                  <div class="dot"></div>
                  <div class="dot"></div>
                </div>
                <div class="buttons" id="buttons-<%= post.postId %>"> 
                  <!-- Initially hidden -->
                  <div class="d-flex justify-content-end align-items-center me-1">
                    <div class="d-flex align-items-center me-4">
                      <% if (userId !==post.userId) { %>
                      <form action="/createConv" method="POST" class="ms-4">
                        <input
                          type="hidden"
                          id="userId2"
                          value="<%= post.userId %>"
                          name="userId2"
                        />
                        <button
                          type="submit"
                          class="btn btn-link p-0 border-0 me-2"
                        >
                          Message
                        </button>
                      </form>
                      <% } %>
                      <button
                        type="button"
                        class="grows btn btn-link p-0 border-0 me-2"
                        
                        onclick="toggleReplySection('<%= post.postId %>')"
                      >
                        <img
                          src="/images/comment.png"
                          alt="Comment"
                          width="30"
                          height="30"
                        />
                      </button>
                      <div class="text-muted small">
                        <%= post.commentCount %> comments
                      </div>
                    </div>
                    <div class="d-flex align-items-center me-4">
                      <button
                        type="submit"
                        id="likeButton"
                        class="grows btn btn-link p-0 border-0 me-2"
                        onclick="toggleLike(event)"
                      >
                        <input
                          type="hidden"
                          name="postId"
                          value="<%= post.postId %>"
                        />
                        <input
                          type="hidden"
                          name="liked"
                          value="<%= post.liked %>"
                        />
                        <input
                          type="hidden"
                          name="likeCount"
                          value="<%= post.likeCount %>"
                        />
                        <% if (post.liked) { %>
                        <img
                          src="/images/likeClicked.png"
                          alt="Like"
                          width="30"
                          height="30"
                        />
                        <% } else { %>
                        <img
                          src="/images/likeUnclicked.png"
                          alt="Like"
                          width="30"
                          height="30"
                        />
                        <% } %>
                      </button>
                      <div class="text-muted small">
                        <%= post.likeCount %> likes
                      </div>
                    </div>
                    <div class="d-flex align-items-center me-4">
                      <% if (post.flagged) { %>
                      <img
                        src="/images/markedFlag.png"
                        alt="Flag"
                        width="40"
                        height="40"
                        class="me-4"
                      />
                      <% } else { %>
                      <button
                        type="button"
                        id="flagButton"
                        class="grows btn btn-link"
                        data-bs-toggle="modal"
                        data-bs-target="#flagModal"
                        onclick="setFlagModalValues('<%= post.postId %>')"
                      >
                        <img
                          src="/images/emptyFlag.png"
                          alt="Flag"
                          width="40"
                          height="40"
                          class="grows me-4"
                        />
                      </button>
                      <% } %>
                      <div class="d-flex align-items-center me-2">
                        <% if (userId===post.userId ) { %>
                          
                          <img class="grows me-4" src="/images/editPost.png"
                            style="cursor: pointer;"
                            alt="editPost"
                            width="40"
                            height="40" 
                            data-bs-toggle="modal"
                            data-bs-target="#editModal"
                            onclick="setEditModalValues('<%= post.postId %>', '<%= post.title %>', '<%= post.courseId %>', '<%= post.description %>')">
                        <% } %>
                        <% if (userId===post.userId || role==='teacher' || role==='moderator' ) { %>
                        <form action="/deleteUserPost" method="POST">
                          <input
                            type="hidden"
                            id="catId"
                            value="<%= catId %>"
                            name="catId"
                          />
                          <input
                            type="hidden"
                            name="postId"
                            value="<%= post.postId %>"
                          />
                          <img class="grows" src="/images/delete.png"
                            style="cursor: pointer me-4;"
                            alt="editPost"
                            width="35"
                            height="35" 
                            data-bs-toggle="modal"
                            data-bs-target="#editModal"
                            onclick="setEditModalValues('<%= post.postId %>', '<%= post.title %>', '<%= post.courseId %>', '<%= post.description %>')">
                          
                        </form>
                        <% } %> 
                        
                    </div>
                      <!-- <button type="button" id="flagButton"
                                                      class="btn btn-link p-0 border-0 me-2" onclick="toggleFlag(event)">
                                                      <img src="/images/emptyFlag.png" alt="Flag" width="40" height="40">
                                                  </button> -->
                    </div>
                  </div>
  
                </div>
                <div style="width: 600px; height: 62px; left: 150px; top: 150px; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 700; word-wrap: break-word;"><%= post.title %></div>
                <div style="width: 600px; height: 62px; left: 150px; top: 200px; position: absolute; color: black; font-size: 12px; font-family: Inter; font-weight: 400; word-wrap: break-word;"><%= post.description %></div>
              </div>
            
              <!-- <div class="replies"> -->
                 <!-- Dynamically calculate height -->
              <span class="reply-section" id="reply-section-<%= post.postId %>" style="display: none;">
                <% if (!post.replies || post.replies.length===0) { %>
                <!-- <p>No replies found, be the first to make one!</p> -->
                <% } else { %> <% post.replies.forEach(reply=> { %>
                  

                  <div style="width: 14px; height: 80px; left: 200px; top: 85px; position: relative; display: flex; flex-direction: column; background: black; pointer-events: none; "></div>
                  <div class="grows" style="position: relative; margin-bottom: -133px; display: flex; flex-direction: column; background: white; top: -80px">
                    <div class="grows" style="width: 40px; height: 40px; left: 170px; top: 140px; position: absolute; background: rgb(255, 255, 255); border-radius: 9999px; border: 1px black solid; z-index: 1;">
                      <a href="/account/<%= reply.userId %>">
                        <img
                          src="/images/<%= reply.profilePic %>"
                          class="rounded-circle"
                          alt="profile"
                          class="rounded-circle"
                          alt="profile"
                          style="width: 100%; height: 100%; object-fit: cover;"> 
                      </a>
                    </div>
                    <div style="width: 335px; height: 100px; left: 220px; top: 145px; position: absolute; z-index: 1;">
                      <span style="color: black; font-size: 20px; font-family: Inter; font-weight: 400; word-wrap: break-word"><%= reply.fname + " " + reply.lname %>- </span>
                      <span style="color: black; font-size: 12px; font-family: Inter; font-weight: 400; word-wrap: break-word"><%= reply.description %></span>
                    </div>
                    <div id="postBox" style="width: 459px; height: 158px; left: 140px; top: 115px; position: absolute; background: rgb(115, 113, 124); border-radius: 19px; border: 1px rgba(13.75, 61.79, 253.94, 0.20) solid"></div>
                    <!-- <div style="width: 8px; height: 8px; left: 431px; top: 165px; position: absolute; background: #0D0D0D; border-radius: 9999px"></div>
                    <div style="width: 8px; height: 8px; left: 431px; top: 151px; position: absolute; background: #0D0D0D; border-radius: 9999px"></div>
                    <div style="width: 8px; height: 8px; left: 431px; top: 135px; position: absolute; background: #0D0D0D; border-radius: 9999px"></div> -->
                    <div id="dots" class="grows" style="position: absolute; left: 580px; top: 190px;"> 
                      <div class="dot"></div>
                      <div class="dot"></div>
                      <div class="dot"></div>
                    </div>
                    
                    
                    
                  </div>     
                  <div style="width: 17px; position: relative; background: black; left: 700px; top: 138px; height: 240px;"></div>
                  
                  
                  <% }) %> 
                  <!-- <div style="width: 17px; height: 232px; left: 700px; top: -102px; position: relative; background: rgb(0, 0, 0)"></div> -->
                  <div class="grows" style=" position: relative; margin-bottom: 100px; display: flex; flex-direction: column; ">
                    
                    <div style="width: 92px; height: 29px; left: 600px; top: 128px; z-index: 2; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; word-wrap: break-word">
                      <button>Comment</button>
                    </div>
                    <div style="width: 257px; height: 29px; left: 200px; top: 128px; z-index: 2; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; word-wrap: break-word">
                      <textarea style="width: 257px; height: 29px;"> text goes here</textarea>
                    </div>
                    <div id="postBox" style="width: 604px; height: 51px; left: 130px; top: 120px; position: absolute; background: rgb(255, 255, 255); box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25); border-radius: 65px; border: 2px black solid"></div>
                  </div>
                </span>
          <% } %>
        
        
        <% }) %> <% } %>
      </div>

              

              
        
        <style>
          
      

          .grows {
            display: inline-block; /* Ensure the element behaves like a block for scaling */
           
          }
  
          .grows:hover {
            transform: scale(1.1); /* Increase size by 20% */
            transform-origin: center; /* Center the scaling */
            transition: transform 0.3s ease; /* Smooth transition */
            z-index: 1;
          }
  
          
          #postBox:hover,
          .grows:hover #postBox {
            box-shadow: 0px 0px 4px 5px rgba(0, 0, 0, 0.25);
          }


          #dots {
            display: flex;
            flex-direction: column;
            gap: 8px; /* Adjust spacing as needed */
          }
      
          .dot {
            width: 8px;
            height: 8px;
            background: #0D0D0D;
            border-radius: 9999px;
            z-index: 1;
          }
          
          .buttons {
            width: 475px;
            height: 50px;
            left: 232px; 
            top: 316px;
            position: absolute;
            opacity: 0.8;
            background: #D9D9D9;
            border-radius: 11px;
            transform: translateX(50%) scale(0); /* Start off screen to the right */
            transition: transform 1s ease; /* Add transition for sliding */
            opacity: 0; /* Make it transparent initially */
            pointer-events: none; /* Prevent interaction when not visible */
            display: flex; /* Use flexbox */
            flex-direction: column; /* Stack items vertically */
            align-items: center; /* Center items horizontally */
            justify-content: center;
            /* transform: scale(0); */
          }

          .buttons.visible {
              transform: translateX(0%) scale(1); /* Slide into position */
              opacity: 1; /* Make it visible */
              pointer-events: auto; /* Allow interaction when visible */
              /* transform: scale(1); */
          }

        

          
        </style>
        
        

        <!-- Resource feed -->
        <div id="resources-content" style="display: none">
          <h2>Resources</h2>
          <% if (!resources || resources.length===0) { %>
          <h2>No resources found, be the first to make one!</h2>
          <% } else { %> <% resources.forEach(resource=> { %>
          <div class="resource">
            <div class="card">
              <div class="card-header">
                <h2><%= resource.title %></h2>
              </div>
              <div
                class="card-body d-flex justify-content-between align-items-center"
              >
                <div class="flex-grow-1 text-center">
                  <a href="https://<%= resource.url %>" class="btn btn-link">
                    <%= resource.url %>
                  </a>
                </div>
                <form
                  action="/download/<%= resource.fileName %>"
                  method="get"
                  class="d-inline"
                >
                  <input
                    type="hidden"
                    name="fileName"
                    value="<%= resource.fileName %>"
                  />
                  <button type="submit" class="btn btn-primary">
                    Download
                  </button>
                </form>
                <% if (role==='teacher' ) { %>
                <form action="/deleteResource" method="POST" class="d-inline">
                  <input
                    type="hidden"
                    name="resourceId"
                    value="<%= resource.resourceId %>"
                  />
                  <input type="hidden" name="catId" value="<%= catId %>" />
                  <input
                    type="hidden"
                    name="fileName"
                    value="<%= resource.fileName %>"
                  />
                  <button type="submit" class="btn btn-danger">Delete</button>
                </form>
                <% } %>
              </div>
            </div>
          </div>
          <br>
          <% }) %> <% } %>
        </div>
      </div>

      <!-- Message bar -->
      <div id="private-messages">
        <h1>Private Messages</h1>
        <% if (convUsers) { %>
        <ul class="users">
          <% convUsers.forEach(user=> { %>
            
            <div style=" position: relative; margin-bottom: 80px; display: flex; flex-direction: column;">
              <div style="width: 351px; height: 75px; left: 7px; top: 7px; position: absolute; background: #16316b; box-shadow: 0px 0px 0px 7px rgba(0, 0, 0, 0.25); border-radius: 138px; border: 3px #E1E118 solid"></div>
              <div class="grows" style="width: 40px; height: 40px; left: 29px; top: 24px; position: absolute; background: #D9D9D9; border-radius: 9999px">
                <a href="/account/<%= user.otherUser.userId %>">
                  <img
                    src="/images/<%= user.otherUser.profilePic %>"
                    class="rounded-circle"
                    alt="profile"
                    class="rounded-circle"
                    alt="profile"
                    style="width: 100%; height: 100%; object-fit: cover;"> 
                </a>
              </div>
              <div style="width: 220px; height: 30px; left: 77px; top: 34px; position: absolute;">
                <a href="/account/<%= user.otherUser.userId %>">
                
                  <span class="pm-name">
                    <%= user.otherUser.fname + " " + user.otherUser.lname %>
                  </span>                
              </a>
              </div>
              <div  style="width: 17px; height: 16px; left: 264px; top: 21px; position: absolute; background: #dbd1d1; z-index: 1;"></div>
              <form action="/getMessagePage" method="GET">
                <input type="hidden" name="convId" value="<%= user.convId %>" />
                <button type="submit" style="left: 271px; top: 29px; position: absolute; border: none; background: none; padding: 0;">
                  <img class="grows" src="/images/mail.png" alt="Message Icon" style="width: 40px; height: 40px;">
                </button>
              </form>
              
              <div style="width: 17px; height: 17px; left: 266px; top: 21px; position: absolute; z-index: 1; color: black; font-size: 12px; font-family: Inter; font-weight: bold; word-wrap: break-word">
                <%= user.unreadCount %>
              </div>
            </div>
          <!-- <li class="user-info"> -->
            <!-- <a href="/account/<%= user.otherUser.userId %>">
              <img
                src="/images/<%= user.otherUser.profilePic %>"
                class="rounded-circle"
                alt="profile"
                height="40"
              />
              <span>
                <%= user.otherUser.fname + " " + user.otherUser.lname %>
              </span>
            </a>
            <span> <%= user.unreadCount %> unread messages </span>
            <form action="/getMessagePage" method="GET">
              <input type="hidden" name="convId" value="<%= user.convId %>" />
              <button type="submit" class="btn btn-primary">Message</button>
            </form> -->
          <!-- </li> -->
          <br />
          <% }) %>
        </ul>
        <% } %>
      </div>
    </div>

    <!-- Resource modal -->
    <div
      class="modal fade"
      id="resourceModal"
      tabindex="-1"
      aria-labelledby="resourceModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="postModalLabel">Add a resource</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form action="/upload" method="POST" enctype="multipart/form-data">
            <input type="hidden" id="catId" value="<%= catId %>" name="catId" />
            <div class="modal-body">
              <div class="mb-3">
                <label for="title" class="form-label">Title</label>
                <input
                  type="text"
                  class="form-control"
                  id="title"
                  name="title"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="description" class="form-label">Link</label>
                <textarea
                  class="form-control"
                  id="url"
                  name="url"
                  rows="1"
                ></textarea>
              </div>
              <div class="mb-3">
                <label for="fileUpload" class="form-label">File upload?</label>
                <input
                  type="file"
                  class="form-control"
                  id="fileUpload"
                  name="file"
                />
              </div>
            </div>
            <div class="modal-footer border-top">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <button type="submit" class="btn btn-primary">Submit</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Post modal -->
    <div
      class="modal fade"
      id="postModal"
      tabindex="-1"
      aria-labelledby="postModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="postModalLabel">Create a Post</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form action="/post" method="POST">
            <input type="hidden" id="catId" value="<%= catId %>" name="catId" />
            <div class="modal-body">
              <div class="mb-3">
                <label for="title" class="form-label">Title</label>
                <input
                  type="text"
                  class="form-control"
                  id="title"
                  name="title"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="courseId" class="form-label">Course ID</label>
                <input
                  type="number"
                  class="form-control"
                  id="courseId"
                  name="courseId"
                  min="100"
                  max="999"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="description" class="form-label">Description</label>
                <textarea
                  class="form-control"
                  id="description"
                  name="description"
                  rows="4"
                  required
                ></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <button type="submit" class="btn btn-primary">Submit</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Edit post modal -->
    <div
      class="modal fade"
      id="editModal"
      tabindex="-1"
      aria-labelledby="editModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editModalLabel">Edit Post</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form action="/editPost" method="POST">
            <input type="hidden" id="catId" value="<%= catId %>" name="catId" />
            <input type="hidden" id="postId" name="postId" />

            <div class="modal-body">
              <div class="mb-3">
                <label for="editTitle" class="form-label">Title</label>
                <input
                  type="text"
                  class="form-control"
                  id="editTitle"
                  name="editTitle"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="editCourseId" class="form-label">Course ID</label>
                <input
                  type="number"
                  class="form-control"
                  id="editCourseId"
                  name="editCourseId"
                  min="100"
                  max="999"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="editDescription" class="form-label"
                  >Description</label
                >
                <textarea
                  class="form-control"
                  id="editDescription"
                  name="editDescription"
                  rows="4"
                  required
                ></textarea>
              </div>
            </div>

            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <button type="submit" class="btn btn-primary">Submit</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Edit reply modal -->
    <div
      class="modal fade"
      id="editReplyModal"
      tabindex="-1"
      aria-labelledby="editReplyModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editReplyModalLabel">Edit Reply</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form action="/editReply" method="POST">
            <input type="hidden" id="catId" value="<%= catId %>" name="catId" />
            <input type="hidden" id="replyId" name="replyId" />

            <div class="modal-body">
              <div class="mb-3">
                <label for="editDescription" class="form-label"
                  >Description</label
                >
                <textarea
                  class="form-control"
                  id="editDescription"
                  name="editDescription"
                  rows="4"
                  required
                ></textarea>
              </div>
            </div>

            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <button type="submit" class="btn btn-primary">Submit</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Reply modal -->
    <div
      class="modal fade"
      id="replyModal"
      tabindex="-1"
      aria-labelledby="replyModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="replyModalLabel">Reply</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form action="/reply" method="POST">
            <input type="hidden" id="catId" value="<%= catId %>" name="catId" />
            <input type="hidden" id="replyPostId" name="postId" />
            <div class="modal-body">
              <div class="mb-3">
                <label for="description" class="form-label">Description</label>
                <textarea
                  class="form-control"
                  id="description"
                  name="description"
                  rows="4"
                  required
                ></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <button type="submit" class="btn btn-primary">Submit</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Flag modal -->
    <div
      class="modal fade"
      id="flagModal"
      tabindex="-1"
      aria-labelledby="flagModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="flagModalLabel">Confirm Flagging</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">Are you sure you want to flag this post?</div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <form action="/flagPost" method="POST">
              <input
                type="hidden"
                id="catId"
                value="<%= catId %>"
                name="catId"
              />
              <input type="hidden" id="flagPostId" name="postId" />
              <button type="submit" class="btn btn-primary">Flag</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>

    <script>
      function setReplyModalValues(postId) {
        document.getElementById("replyPostId").value = postId;
      }

      function setEditModalValues(postId, title, courseId, description) {
        document.getElementById("postId").value = postId;
        document.getElementById("editTitle").value = title;
        document.getElementById("editCourseId").value = courseId;
        document.getElementById("editDescription").value = description;
      }

      function setEditReplyModalValues(replyId, description) {
        document.getElementById("replyId").value = replyId;
        document.getElementById("editDescription").value = description;
      }

      function setFlagModalValues(postId) {
        document.getElementById("flagPostId").value = postId;
      }

      

      function toggleButtons(buttonId) {
        const buttonDiv = document.getElementById(buttonId); // Get the specific buttons div
        const isVisible = buttonDiv.classList.contains("visible"); // Check current visibility
        if (isVisible) {
            buttonDiv.classList.remove("visible"); // Remove visible class
        } else {
            buttonDiv.classList.add("visible"); // Add visible class
        }
     }

     function toggleReplySection(postId) {
      const replySection = document.getElementById(`reply-section-${postId}`);
      if (replySection.style.display === "none") {
        replySection.style.display = "block"; // Show the reply section
      } else {
        replySection.style.display = "none"; // Hide the reply section
      }
    }

    </script>
  </body>
</html>